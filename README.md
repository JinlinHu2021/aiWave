# aiWave: Volumetric Image Compression with 3-D Trained Affine Wavelet-like Transform


**Official implementation** of the following paper

Dongmei Xue, Haichuan Ma, Li Li, Dong Liu, and Zhiwei Xiong, aiWave: Volumetric Image Compression with 3-D Trained Affine Wavelet-like Transform. Submit to IEEE Transactions on Medical Imaging.



## Dependencies

- Python 3.6 
- TensorFlow 1.14.0
- Numpy 1.17.3
- pandas 1.1.5
- dask 2.9.1
- [SimpleITK 2.1.1.2](https://pypi.org/project/SimpleITK/) 



## Usage

### 1. Preparation

- We make experiments on the luminance channel which could generated by MATLAB function [rgb2ycbcr](https://www.mathworks.com/help/images/ref/rgb2ycbcr.html).
- Download our processed data from [BaiduYun](https://pan.baidu.com/s/16pChtBkmeS_rz6-Bm4CWhA) (Access code: cvpr) or [GoogleDrive](https://drive.google.com/drive/folders/1O02hmUpFjgb92ysteO0D9v7as64NcyUI?usp=sharing) and put them into the folder data. 
- Download our pre-trained model from [BaiduYun](https://pan.baidu.com/s/1pwj4BcKjmPIz_YJ9ZzXktQ) (Access code: cvpr) or [GoogleDrive](https://drive.google.com/drive/folders/1-sJLzVqz4O7PSHx_tvz2766izBJnfqmP?usp=sharing) and put them into the folder pretrain.
- If you want the ground truth HR light field images with RGB channels, please download them from [BaiduYun](https://pan.baidu.com/s/14dw4SaqhpNf6_RZNvXFvLA) (Access code: cvpr) or [GoogleDrive](https://drive.google.com/file/d/1bBlljZ0gg9E5VxdZT91cDJPhzOw75cev/view?usp=sharing).



### 2. Zero-shot learning from scratch

Take scene *Spear_Fence_2* in dataset *EPFL* with scaling factor 2 as an example.

```shell
python Main_LFZSSR.py --dataset="EPFL" --start=2 --end=3 --scale=2 --record
```

You can refer to the script [Main_LFZSSR.py](https://github.com/Joechann0831/LFZSSR/blob/master/Main_LFZSSR.py) to know the meaning of each parameter. 

### 3. Error-guided finetuning

Our error-guided finetuning needs a pre-trained model for initialization and error map generation, please download our pre-trained models.

Take scene *Spear_Fence_2* in dataset *EPFL* with scaling factor 2 and source dataset *HFUT* as an example.

```shell
python Main_error_guided_finetuning.py --dataset="EPFL" --start=2 --end=3 --scale=2 --source="HFUT" --record
```

You can refer to the script [Main_error_guided_finetuning.py](https://github.com/Joechann0831/LFZSSR/blob/master/Main_error_guided_finetuning.py) to know the meaning of each parameter.

### 4. Hyper-parameters

We set the hyper-parameters during training and testing after tuning on our testing data. If you want to use our algorithm on your own data, please refer to [Hyper-parameters](https://github.com/Joechann0831/LFZSSR/tree/master/hyper-parameters) for detailed descriptions of each hyper-parameter.

## Citation

If you find this work helpful, please consider citing our paper.

```latex
@InProceedings{Cheng_2021_CVPR,
    author    = {Cheng, Zhen and Xiong, Zhiwei and Chen, Chang and Liu, Dong and Zha, Zheng-Jun},
    title     = {Light Field Super-Resolution With Zero-Shot Learning},
    booktitle = {Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)},
    month     = {June},
    year      = {2021},
    pages     = {10010-10019}
}
```

## Related Projects

[Light field depth estimation, LFDEN](https://github.com/JiayongO-O/LFDEN)

[ZSSR](https://github.com/assafshocher/ZSSR)

## Contact

If you have any problem about the released code, please do not hesitate to contact me with email (mywander@mail.ustc.edu.cn).
